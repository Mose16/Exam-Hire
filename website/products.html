<!DOCTYPE.html>
<html>
	%include('Shared/header.html')
	<head>
		<link href="/css/products.css" rel="stylesheet" type="text/css">
		<link href="/script/products.js">
		<script src="jquery-3.3.1.min.js"></script>
	</head>
	<body>
		<div class="grid">
			<div id="top"> 
				<p>Rent a Bro</p> 
				<div class="dropdown">
					<i class="material-icons" style="font-size: 40px;">view_module</i>
					<div class="dropdown-content">
						<a href="poo poo"><div><p>Meet The Bros</p></div></a>
						<a href=""><div><p>Write A Review</p></div></a>
						<a href=""><div><p>Apply To Be A Bro</p></div></a>
					</div>
				</div>
			</div>
			<div id="center"> 
				%for bro in bros_list:
					<div id="{{bro.name}}" style="margin-top: 0; margin-left: 0;">
						<h1>{{bro.name}}</h1>
					</div>
				%end
			</div>
			<div id="bottom">
				<p style="display:inline">Dont be dissapointed when you see the products.  |</p> <address style="display:inline">admin@rentabro.co.nz</address>
			</div>
			<div id="fill" style="width:100vw; height:0;">
			</div>
		</div>
	</body>
	
	<script>
		var divs = document.querySelectorAll('#center div');
		console.log(divs.length);
		var speed = 1.5;
		var fill = document.getElementById("fill");

		window.addEventListener('scroll', function() {
			if (pageYOffset < (document.body.offsetHeight - parseInt(fill.style.height) - window.innerHeight)) {
				console.log((document.body.offsetHeight - parseInt(fill.style.height) - window.innerHeight));
				for (i = 0; i < divs.length; i++) {
					//animationY(divs[i].id);
					animationY(divs[1].id);
					//animationPX(divs[2].id);
				};
			} else {
				document.body.scrollTop = (document.body.offsetHeight - parseInt(fill.style.height) - window.innerHeight)
				console.log((document.body.offsetHeight - parseInt(fill.style.height) - window.innerHeight));
			}
		});
		
		//Move up
		function animationY(id) {
			var elmnt = document.getElementById(id);
			elmnt.style.marginTop = -(pageYOffset * speed);
			fill.style.height = (pageYOffset * speed);
		};
		
		//Move right
		function animationPX(id) {
			console.log(id);
			var elmnt = document.getElementById(id);
			
			var check = isInViewport(elmnt);
			if (check[0] && parseInt(elmnt.style.marginLeft) < 450) {
				elmnt.style.marginLeft = (pageYOffset - check[1]);
			};
		};
		
		//Check if element is visible
		var found = true;
		var position = 0;
		var isInViewport = function (el) {
			var bool = false;
			var box = el.getBoundingClientRect();
			if (box.top <= (pageYOffset + window.innerHeight)) {
				if (found) {
					found = false;
					position = pageYOffset;
					console.log("yeop");
				}
				bool = true;
			};
			console.log(box.top, bool);
			return ([bool, position])
		};
	</script>
</html>